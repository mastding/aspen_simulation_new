thought_process_prompt = f"""
请按照以下步骤思考，并在思考过程中展示你的推理过程：
步骤1：分析用户描述的化工流程
- 识别主要设备单元和模拟类型，确定是单元模拟还是流程模拟，是否需要包含循环物流
- 理解物料流向
- 确定关键操作参数

步骤2：设计流程结构
- 识别流程是否包含循环，当前流程包含循环时，请遵循“分步设计、逐步收敛”的原则，按如下子步骤执行，先设计开环流程，调用模拟工具运行，确保各单元操作收敛后，再逐步添加循环流股，最终形成闭环：
1. **流程分解**：先将整个流程分解为多个串联步骤（如物料混合→反应→分离→精馏等）
2. **开环设计**：从第一步开始设计，先生成一个不含循环的开环流程配置
3. **逐步收敛**：
   - 调用模拟工具运行当前配置
   - 检查收敛情况，确保当前步骤模拟成功
   - 根据模拟结果调整参数，或添加下一步设备
   - 重复此过程，逐步扩展流程
4. **循环闭合**：当所有主要单元都添加完毕且收敛后，最后添加循环流股，形成闭环
5. **精馏塔特殊处理**：如需精馏塔严格计算，先用DSTWU简捷设计塔获取初值，将工具返回的初值结果反馈给用户，确认后再替换为严格计算模块
- 如果流程不包含循环，则直接选择合适的设备类型，特别注意如果是Radrac精馏塔任务，需要先生成DSWTU设备配置，并模拟运行获取回流比、塔板数初值结果。
- 设计合理的连接关系，连接关系必须符合JSON Schema的block_connections的枚举定义，不要编造P1(OUT)等新的端口配置
- 确定物料平衡、质量平衡。

步骤3：验证配置逻辑，必须符合JSON Schema的格式和检查要求
- 检查端口连接的正确性，端口关系必须符合JSON Schema的block_connections枚举定义，不要编造P1(OUT)等新的端口配置
- 验证冷凝器类型与流股的匹配
- 确保反应器配置合理，需检查并确保配置的反应物与产物的总原子数守恒。

步骤4：生成最终配置。
- 严格按照JSON Schema格式
- 确保所有必填字段完整
- 验证配置逻辑一致性

并遵循“分步设计、逐步收敛”的原则：当用户提出包含循环的化工流程任务时，需要先设计开环流程，确保各单元操作收敛后，再逐步添加循环流股，最终形成闭环：

【特别重要的分步设计原则】：
当流程包含循环时，请按以下步骤执行：
"""